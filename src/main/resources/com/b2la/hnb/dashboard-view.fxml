<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.*?>

<BorderPane prefHeight="400.0" prefWidth="600.0" stylesheets="@styles.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.b2la.hnb.controllers.DashboardController">
    <!-- Top Header -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header">
            <ImageView fitHeight="30.0" fitWidth="30.0" pickOnBounds="true" preserveRatio="true">
                <image>
                    <Image url="@images/logo.png" />
                </image>
            </ImageView>
            <Label styleClass="header-title" text="HNB Pâtisserie" />
            <Region HBox.hgrow="ALWAYS" />
            <HBox alignment="CENTER_RIGHT" spacing="10">
                <Label fx:id="dateHeure" styleClass="user-label" text="Admin" />
                <Button styleClass="icon-button">
                    <graphic>
                        <FontIcon iconColor="white" iconLiteral="fa-bell" iconSize="20" />
                    </graphic>
                </Button>
            </HBox>
        </HBox>
    </top>

    <!-- Sidebar -->
    <left>
        <VBox spacing="15" styleClass="sidebar">
            <VBox alignment="CENTER" styleClass="user-profile">
                <FontIcon iconLiteral="fa-user-circle" iconSize="48" styleClass="profile-icon" />
                <Label fx:id="username" styleClass="profile-name" text="John Doe" />
                <Label fx:id="fonction" styleClass="profile-role" text="Administrateur" />
            </VBox>

            <Separator styleClass="divider" />

            <VBox spacing="5" styleClass="menu-container">
                <Button fx:id="home" graphicTextGap="15" onAction="#homeView" styleClass="menu-button active" text="Tableau de bord">
                    <graphic>
                        <FontIcon iconLiteral="fa-tachometer" iconSize="16" />
                    </graphic>
                </Button>
                <Button fx:id="facturation" graphicTextGap="15" onAction="#factureView" styleClass="menu-button" text="Facturation">
                    <graphic>
                        <FontIcon iconColor="#c3bcbc" iconLiteral="fa-file-text" iconSize="16" styleClass="icon-color" />
                    </graphic>
                </Button>
                <Button fx:id="produit" graphicTextGap="15" onAction="#produitView" styleClass="menu-button" text="Produits">
                    <graphic>
                        <FontIcon iconLiteral="fa-glass" iconSize="16" styleClass="icon-color" />
                    </graphic>
                </Button>
                <Button fx:id="depense" graphicTextGap="15" onAction="#depenseView" styleClass="menu-button" text="Depenses">
                    <graphic>
                        <FontIcon iconLiteral="fa-area-chart" iconSize="16" styleClass="icon-color" text="" />
                    </graphic>
                </Button>
                <Button fx:id="cloture" graphicTextGap="15" onAction="#clotureView" styleClass="menu-button" text="Clotures">
                    <graphic>
                        <FontIcon iconLiteral="fa-cart-arrow-down" iconSize="16" styleClass="icon-color" />
                    </graphic>
                </Button>
                <Button fx:id="parametre" graphicTextGap="15" onAction="#parametreView" styleClass="menu-button" text="Paramètres">
                    <graphic>
                        <FontIcon iconLiteral="fa-cog" iconSize="16" styleClass="icon-color" />
                    </graphic>
                </Button>
            </VBox>

            <Region VBox.vgrow="ALWAYS" />

            <Button graphicTextGap="15" styleClass="logout-button" text="Déconnexion">
                <graphic>
                    <FontIcon iconLiteral="fa-sign-out" iconSize="16" />
                </graphic>
            </Button>
        </VBox>
    </left>

    <!-- Main Content -->
    <center>
        <VBox spacing="20" styleClass="content">
            <!-- Stats Cards -->
            <HBox spacing="20" styleClass="stats-row">
                <VBox styleClass="stat-card primary">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fa-line-chart" iconSize="24" styleClass="stat-icon" />
                        <VBox spacing="5">
                            <Label styleClass="stat-value" text="12,345" />
                            <Label styleClass="stat-label" text="Visiteurs" />
                        </VBox>
                    </HBox>
                    <HBox alignment="CENTER_LEFT" spacing="5">
                        <Label styleClass="stat-trend positive" text="+12%" />
                        <FontIcon iconLiteral="fa-arrow-up" iconSize="12" styleClass="trend-icon" />
                    </HBox>
                </VBox>

                <VBox styleClass="stat-card dark">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fa-shopping-cart" iconSize="24" styleClass="stat-icon" />
                        <VBox spacing="5">
                            <Label styleClass="stat-value" text="8,642" />
                            <Label styleClass="stat-label" text="Commandes" />
                        </VBox>
                    </HBox>
                    <HBox alignment="CENTER_LEFT" spacing="5">
                        <Label styleClass="stat-trend positive" text="+5%" />
                        <FontIcon iconLiteral="fa-arrow-up" iconSize="12" styleClass="trend-icon" />
                    </HBox>
                </VBox>
            </HBox>
         <StackPane>
            <children>
               <VBox fx:id="loadingLayout" spacing="10" styleClass="section" visible="false">
                   <padding>
                       <Insets bottom="20" left="20" right="20" top="20" />
                   </padding>

                   <ProgressBar fx:id="progressBar" maxWidth="1.7976931348623157E308" minHeight="10" prefWidth="300" styleClass="progress-bar" />

                   <Label fx:id="loadingText" styleClass="loading-text" text="Chargement en cours..." />
               </VBox>

                  <!-- Recent Activity -->
                  <VBox fx:id="homeLayout" spacing="10" styleClass="section" visible="false">
                      <HBox alignment="CENTER_LEFT" spacing="10">
                          <FontIcon iconLiteral="fa-history" iconSize="18" styleClass="section-icon" />
                          <Label styleClass="section-title" text="Activité Récente" />
                          <Region HBox.hgrow="ALWAYS" />
                          <Button styleClass="text-button" text="Voir tout" />
                      </HBox>

                      <VBox styleClass="activity-list">
                          <HBox styleClass="activity-item">
                              <FontIcon iconLiteral="fa-shopping-cart" iconSize="20" styleClass="activity-icon" />
                              <VBox styleClass="activity-details">
                                  <Label styleClass="activity-title" text="Nouvelle commande #1256" />
                                  <Label styleClass="activity-time" text="Il y a 2 minutes" />
                              </VBox>
                              <Button styleClass="small-button" text="Voir" />
                          </HBox>
                      </VBox>
                  </VBox>
<!--               <VBox fx:id="facturationLayout" spacing="10" styleClass="section" />-->
                <VBox fx:id="facturationLayout" spacing="10" styleClass="section">
                    <Label styleClass="section-title" text="Système de Facturation" />
                  <HBox prefHeight="100.0" prefWidth="200.0">
                     <children>
      
                          <!-- Informations client -->
                          <GridPane hgap="10" vgap="5">
                              <Label text="Client:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                              <ComboBox fx:id="clientComboBox" GridPane.columnIndex="1" GridPane.rowIndex="0" />
      
                              <Label text="Nom:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                              <TextField fx:id="nomClientField" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                           <columnConstraints>
                              <ColumnConstraints />
                              <ColumnConstraints />
                           </columnConstraints>
                           <rowConstraints>
                              <RowConstraints />
                              <RowConstraints />
                           </rowConstraints>
                          </GridPane>
                     </children>
                  </HBox>

                    <!-- Articles/Produits -->
                    <TableView fx:id="articlesTable" prefHeight="134.0" prefWidth="250.0" styleClass="data-table">
                        <columns>
                            <TableColumn fx:id="produitCol" text="Produit" />
                            <TableColumn fx:id="prixUnitaireCol" text="Prix Unitaire" />
                            <TableColumn fx:id="quantiteCol" text="Quantité" />
                            <TableColumn fx:id="totalCol" text="Total" />
                        </columns>
                    </TableView>

                    <!-- Ajout d'articles -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <ComboBox fx:id="produitComboBox" promptText="Sélectionner un produit" />
                        <TextField fx:id="quantiteField" promptText="Quantité" />
                        <Button onAction="#ajouterArticle" styleClass="action-button" text="Ajouter" />
                    </HBox>

                    <!-- Total et validation -->
                    <HBox alignment="CENTER_RIGHT" spacing="20">
                        <Label styleClass="total-label" text="Total:" />
                        <Label fx:id="totalFactureLabel" styleClass="total-amount" text="0.00" />
                    </HBox>

                    <HBox alignment="CENTER_RIGHT" spacing="10">
                        <Button onAction="#genererFacture" styleClass="primary-button" text="Générer Facture" />
                        <Button onAction="#annulerFacture" styleClass="secondary-button" text="Annuler" />
                    </HBox>
                </VBox>
               <VBox fx:id="produitLayout" spacing="10" styleClass="section" visible="false" />
               <VBox fx:id="depenseLayout" spacing="10" styleClass="section" visible="false" />
               <VBox fx:id="clotureLayout" spacing="10" styleClass="section" visible="false" />
               <VBox fx:id="parametreLayout" spacing="10" styleClass="section" visible="false" />
            </children>
         </StackPane>
        </VBox>
    </center>
</BorderPane>
